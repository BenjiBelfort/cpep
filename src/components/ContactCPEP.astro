---
import { Icon } from 'astro-icon/components';
---

<section id="contact" aria-labelledby="contact-title" class="mx-auto max-w-6xl px-4 py-16 scroll-m-4">
  <header class="text-center max-w-2xl mx-auto">
    <h2 id="contact-title" class="text-2xl md:text-3xl font-bold text-gray-900">Contact</h2>
    <p class="mt-3 text-text">
      Dites-nous ce dont vous avez besoin. Réponse sous <strong>24–48 h</strong>. Pas de blabla, du concret.
    </p>
  </header>

  <div class="mt-8 grid gap-8 md:grid-cols-2 items-start">
    <!-- Infos -->
    <aside class="rounded-xl border border-bg-alt bg-white p-5">
      <ul class="space-y-4">
        <li class="flex items-start gap-3">
          <Icon name="lucide:mail" class="h-5 w-5 text-primary mt-0.5" aria-hidden="true" />
          <div>
            <p class="font-semibold text-text">Email</p>
            <a href="mailto:contact@cpep.fr" class="underline decoration-accent underline-offset-4">contact@cpep.fr</a>
          </div>
        </li>
        <li class="flex items-start gap-3">
          <Icon name="lucide:phone" class="h-5 w-5 text-primary mt-0.5" aria-hidden="true" />
          <div>
            <p class="font-semibold text-text">Téléphone</p>
            <a href="tel:+33XXXXXXXXX" class="underline decoration-accent underline-offset-4">+33 X XX XX XX XX</a>
          </div>
        </li>
        <li class="flex items-start gap-3">
          <Icon name="lucide:map-pin" class="h-5 w-5 text-primary mt-0.5" aria-hidden="true" />
          <div>
            <p class="font-semibold text-text">Zone</p>
            <p class="text-gray-800">France & Europe — partenaires proches, délais maîtrisés</p>
          </div>
        </li>
      </ul>

      <div class="mt-6 rounded-lg bg-primary/5 p-4 text-sm text-text">
        <p class="font-medium">Astuce</p>
        <p class="mt-1">Pour un <strong>devis précis</strong>, indiquez les <em>quantités</em>, <em>formats</em>, <em>matières/finitions</em> (print) ou les <em>fonctionnalités</em> (web).</p>
      </div>
    </aside>

    <!-- Form Netlify -->
    <form
      name="contact-cpep"
      method="POST"
      action="/merci"
      data-netlify="true"
      netlify-honeypot="bot-field"
      class="rounded-xl border border-bg-alt bg-white p-5"
      aria-describedby="contact-help"
    >
      <!-- Netlify needs this -->
      <input type="hidden" name="form-name" value="contact-cpep" />
      <!-- Honeypot -->
      <p class="hidden">
        <label>Ne pas remplir : <input name="bot-field" /></label>
      </p>

      <div class="grid gap-4 md:grid-cols-2">
        <label class="block">
          <span class="text-sm font-medium text-text">Votre nom *</span>
          <input name="name" required autocomplete="name" class="mt-1 w-full rounded-lg border border-bg-alt bg-bg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent" />
        </label>

        <label class="block">
          <span class="text-sm font-medium text-text">Email *</span>
          <input type="email" name="email" required autocomplete="email" class="mt-1 w-full rounded-lg border border-bg-alt bg-bg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent" />
        </label>

        <label class="block">
          <span class="text-sm font-medium text-text">Téléphone</span>
          <input type="tel" name="phone" autocomplete="tel" class="mt-1 w-full rounded-lg border border-bg-alt bg-bg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent" />
        </label>

        <label class="block">
          <span class="text-sm font-medium text-text">Société</span>
          <input name="company" autocomplete="organization" class="mt-1 w-full rounded-lg border border-bg-alt bg-bg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent" />
        </label>

        <label class="block md:col-span-2">
          <span class="text-sm font-medium text-text">Type de projet</span>
          <select name="project_type" class="mt-1 w-full rounded-lg border border-bg-alt bg-bg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent">
            <option>Print (sacs, boîtes, étiquettes…)</option>
            <option>Web (site vitrine, SEO, maintenance)</option>
            <option>Autre</option>
          </select>
        </label>

        <label class="block md:col-span-2">
          <span class="text-sm font-medium text-text">Budget indicatif</span>
          <select name="budget" class="mt-1 w-full rounded-lg border border-bg-alt bg-bg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent">
            <option>À définir</option>
            <option>&lt; 1 000 €</option>
            <option>1 000 – 3 000 €</option>
            <option>3 000 – 8 000 €</option>
            <option>&gt; 8 000 €</option>
          </select>
        </label>

        <label class="block md:col-span-2">
          <span class="text-sm font-medium text-text">Votre message *</span>
          <textarea name="message" required rows={6} class="mt-1 w-full rounded-lg border border-bg-alt bg-bg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent"></textarea>
        </label>

        <label class="md:col-span-2 flex items-start gap-2">
          <input type="checkbox" name="consent" required class="mt-1 h-4 w-4 rounded border-bg-alt" />
          <span class="text-sm text-gray-800">
            J’accepte que mes données soient utilisées pour répondre à ma demande. (Pas de spam, jamais.)
          </span>
        </label>

        <div class="md:col-span-2">
          <button type="submit" class="inline-flex items-center gap-2 rounded-full bg-primary px-5 py-2 text-white hover:opacity-90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent">
            <Icon name="lucide:send" class="h-4 w-4" aria-hidden="true" /> Envoyer
          </button>
          <p id="contact-help" class="mt-2 text-xs text-gray-700">Réponse sous 24–48 h ouvrées.</p>
        </div>
      </div>
    </form>
  </div>

  <!-- JSON-LD ContactPage -->
  <script type="application/ld+json">
  {JSON.stringify({
    "@context":"https://schema.org",
    "@type":"ContactPage",
    "name":"Contact CPEP",
    "description":"Demande de devis et d’informations pour emballages personnalisés et services web.",
    "url": Astro.site ? new URL(Astro.url.pathname, Astro.site).toString() : "/#contact",
    "publisher": { "@type":"Organization", "name":"CPEP" },
    "contactPoint": [{
      "@type":"ContactPoint",
      "contactType":"customer support",
      "email":"contact@cpep.fr",
      "areaServed":"FR"
    }]
  })}
  </script>
</section>
